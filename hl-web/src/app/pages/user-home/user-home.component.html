<!-- User home component template -->
<div class="user-home-container">
  <mat-card class="welcome-card">
    <mat-card-title>{{ 'userHome.welcome' | translate:{ name: displayName } }}</mat-card-title>
    @if (clientName) {
      <mat-card-subtitle>{{ 'userHome.portfolio' | translate:{ client: clientName } }}</mat-card-subtitle>
    }
    <mat-card-content>
      <div class="metrics">
        <div class="metric">
          <span class="metric-label">{{ 'userHome.metrics.deals' | translate }}</span>
          <span class="metric-value">{{ totalDeals }}</span>
        </div>
        <div class="metric">
          <span class="metric-label">{{ 'userHome.metrics.volume' | translate }}</span>
          <span class="metric-value">{{ totalAmount | currency }}</span>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  @if (loading) {
    <mat-card class="state-card">
      <mat-card-content>
        <p>{{ 'userHome.loading' | translate }}</p>
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </mat-card-content>
    </mat-card>
  } @else {
    @if (error) {
      <mat-card class="state-card error">
        <mat-card-content>
          <p>{{ error }}</p>
        </mat-card-content>
      </mat-card>
    } @else {
      @if (totalDeals === 0) {
        <mat-card class="state-card empty">
          <mat-card-content>
            <p>{{ 'userHome.empty' | translate:{ client: clientName ?? ('userHome.emptyClient' | translate) } }}</p>
          </mat-card-content>
        </mat-card>
      } @else {
        <section class="deals-grid">
          @for (deal of filteredDeals; track deal.id) {
            <mat-card class="deal-card">
              <mat-card-header>
                <div mat-card-avatar class="avatar">{{ deal.client | slice:0:1 }}</div>
                <mat-card-title>{{ deal.name }}</mat-card-title>
                <mat-card-subtitle>{{ deal.client }}</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <p class="amount">{{ deal.amount | currency }}</p>
                <p class="date">{{ 'userHome.created' | translate:{ date: (deal.createdAt | date: 'mediumDate') } }}</p>
              </mat-card-content>
            </mat-card>
          }
        </section>
      }
    }
  }
</div>
